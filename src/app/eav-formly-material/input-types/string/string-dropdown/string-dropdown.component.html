<mat-select *ngIf="!to.freeTextMode" [id]="id" class="form-control input-material material" [formControl]="formControl" [formlyAttributes]="field"
  [multiple]="to.multiple" (selectionChange)="to.change && to.change(field, formControl)" [errorStateMatcher]="errorStateMatcher">
  <ng-container *ngFor="let item of selectOptions">
    <mat-optgroup *ngIf="item.group" label="{{item.label}}">
      <mat-option *ngFor="let child of item.group" [value]="child[valueProp]" [disabled]="child.disabled">
        {{ child[labelProp] }}
      </mat-option>
    </mat-optgroup>
    <mat-option *ngIf="!item.group" [value]="item[valueProp]" [disabled]="item.disabled">{{ item[labelProp] }}</mat-option>
  </ng-container>
</mat-select>

<!-- TODO: formly-skip-ng-model-attrs-manipulator - i think we don't need this any more??? was angular issue for ngModel
EXAMPLE : https://github.com/formly-js/angular-formly/issues/499 -->
<input matInput *ngIf="to.freeTextMode" [type]="type" [id]="id" class="form-control input-material material" [errorStateMatcher]="errorStateMatcher"
  [formControl]="formControl" [formlyAttributes]="field">

<a *ngIf="to.settings.EnableTextEntry.values[0].value" class="input-group-addon icon-field-button icon-field-button-small"
  [class]="'input-group-addon icon-field-button icon-field-button-small' + (to.freeTextMode ? ' active' : '')" (click)="to.freeTextMode=! to.freeTextMode ">
  <span *ngIf="to.freeTextMode " class="eav-icon-down-dir ">icon-select</span>
  <span *ngIf="!to.freeTextMode " class="eav-icon-i-cursor ">icon-free</span>
</a>