<!-- !modes.freeTextMode && -->
<mat-list *ngIf="enableCreate || chosenEntities.length > 0">
  <mat-list-item *ngFor="let item of chosenEntities">
    <p matLine>
      <!-- ng-show="!allowMultiValue" -->
      <i class="material-icons">check</i>
      <span [title]="getEntityText(item)">{{ getEntityText(item) }}</span>
      <!-- edit -->
      <button mat-icon-button *ngIf="enableEdit" type="button" (click)="editEntity(item)">
        <i class="material-icons">edit</i>
      </button>
      <!-- remove -->
      <button mat-icon-button *ngIf="enableRemove" type="button" (click)="removeEntity(item)">
        <i class="material-icons">{{allowMultiValue ? 'remove' : 'arrow_drop_down'}}</i>
      </button>
      <!-- delete -->
      <button mat-icon-button *ngIf="enableDelete" type="button" (click)="deleteEntity(item)">
        <i class="material-icons">delete</i>
      </button>
    </p>
  </mat-list-item>
</mat-list>

<!-- pick existing entity -->
<!-- ng-if="!modes.freeTextMode" -->

<div *ngIf="enableAddExisting && (allowMultiValue || chosenEntities.length < 1)">
  <mat-form-field [style.width]="'100%'">
    <input matInput type="text" #autocompleteInput [id]="id" [placeholder]="config.label" [matAutocomplete]="auto">

    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="optionSelected($event)">
      <mat-option *ngFor="let item of (selectEntities | async)" [value]="item.entity.guid" [disabled]="isInChosenEntities(item.entity.guid)">
        <span>{{item.entity.attributes['Name'] ? item.entity.attributes['Name'].values[0].value : item.entity.guid}} {{value}}</span>
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>
  <!--  <ui-select-no-choice class="bg-warning">
        <span ng-if="!error">{{ 'FieldType.EntityQuery.QueryNoItems' | translate }}</span>
        <span ng-if="error">{{error}}</span>
      </ui-select-no-choice>
    </ui-select> -->
</div>

<!-- create new entity to add to this list -->
<button mat-icon-button *ngIf="enableCreate && entityType !== '' && (allowMultiValue || chosenEntities.length < 1)" type="button"
  (click)="openNewEntityDialog()">
  <i class="material-icons">add_circle</i>
</button>



<!-- Do we need this ??? -->
<!-- handle free text mode -->
<!-- <input ng-show="modes.freeTextMode" class="form-control input-material material" ng-model="value.Value" formly-skip-ng-model-attrs-manipulator
  type="text">
<a ng-show="to.settings.merged.EnableTextEntry && (to.settings.merged.AllowMultiValue || chosenEntities.length < 1)" class="freetext-toggle input-group-addon icon-field-button icon-field-button-small"
  ng-class="{'active': modes.freeTextMode}" ng-click="modes.freeTextMode = !modes.freeTextMode">

  <span ng-show="modes.freeTextMode" class="eav-icon-down-dir"></span>
  <span ng-show="!modes.freeTextMode" class="eav-icon-i-cursor"></span>
</a> -->